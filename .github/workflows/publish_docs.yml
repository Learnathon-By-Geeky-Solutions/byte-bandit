name: Deploy Docs to Vercel
on:
    push:
        branches:
            - '*'
        paths:
            - 'docs/**'
jobs:
    deploy:
        runs-on: ubuntu-latest
        steps:
            -   name: Checkout Repository
                uses: actions/checkout@v4

            -   name: Set Up Python 3.9
                uses: actions/setup-python@v4
                with:
                    python-version: '3.9'

            -   name: Install MkDocs Dependencies
                working-directory: docs
                run: |
                    pip install -r requirements.txt

            -   name: Build MkDocs Site
                working-directory: docs
                run: |
                    mkdocs build

            -   name: Install Vercel CLI
                run: npm install -g vercel

            -   name: Deploy to Vercel
                working-directory: docs
                env:
                    VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}
                run: |
                    cd site
                    BRANCH_NAME="${GITHUB_REF##*/}"
                    if [ "$BRANCH_NAME" = "main" ]; then
                      echo "Deploying to production (main branch)..."
                      vercel --prod --token $VERCEL_TOKEN --confirm
                    else
                      echo "Deploying to preview for branch: $BRANCH_NAME"
                      vercel --token $VERCEL_TOKEN --confirm
                    fi
